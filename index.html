<!DOCTYPE html>

<html lang = "eng">
	<head>
	<!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <title>IT202 Project 1</title>
    <!--Ensures following screens are hidden when opened -->
    <style>
      .screen{display:none;}
    </style>
	<!--Sizes the map-->
    <style type="text/css">
              #map {
                height: 400px;
                width: 100%;
              }
      </style>
	<!-- Ensures template is hidden for the Cards -->
        <style>
          .template {
            display:none;
          }
        </style>
	</head>
	<body>
	  <!-- Creates the top navigation bar -->
	  <nav class="navbar navbar-expand-lg navbar-light bg-light">
       <a class="navbar-brand" href="#">Ecologication - Landscaping made easy</a>
      	<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
        	<span class="navbar-toggler-icon"></span>
      	</button>
      <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
        <div class="navbar-nav"> 
		<!--Buttons on the top navigation bar -->
          <a data-screen="home" class="nav-item nav-link" >Home/Instructions</a>
          <a data-screen="form" class="nav-item nav-link" >Form</a>
          <a data-screen="data" class="nav-item nav-link" >Data</a>
          <a data-screen="map" class="nav-item nav-link" >Map</a> 
          <a data-screen="about" class="nav-item nav-link" >About</a>                  
        </div>
      </div>
      
    </nav>
	<div id="content">
    <!-- Home page -->
      <div class="screen" id="home">
        <center>
          <div class="card">
            <div class="card-header">
              Home Page 
            </div>
              <div class="card-body">
                <h5 class="card-title">Goal</h5>
                  <p class="card-text">This following project consists of a Single-Page App that allows users to access and search the Chicago City-Owned Land Inventory database.</p>
                    <a href="https://dev.socrata.com/foundry/data.cityofchicago.org/aksk-kvfp" class="btn btn-primary">Link to said database</a>
                </div>
        </div>
        </center>
      </div>
	<!-- Search page -->
      <div class="screen" id="form">
        <center>
          <div class="card w-75">
            <div class="card-body">
              <h5 class="card-title">Search</h5>
              <p class="card-text">Enter the ward number</p>
              <form class="d-flex" >
                <input class="form-control me-2" id="ward" type="search" placeholder="Enter the number here..." >
              </form>
              <button  id= "searchButton" class="btn btn-outline-success">Click here to search after entering the ward number</button>  
            </div>
          </div>
        </center>
      </div>
	 <!-- Results page -->
      <div class="screen" id="data">
        <center>
        <h1>Results page</h1>
          <div class="alert alert-primary" role="alert">
            Here's what we found:
          </div>
        </center>
          <!-- Main code for card -->
            <div class="container">

              <div class="row">
                <div class="card template" >
                  <div class="card-body">
                    <h5 class="card-title">Card title</h5>
                    <h6 class="card-subtitle mb-2 text-muted">Card subtitle</h6>
                    <p class="card-text">Sample text.</p>
                    <p2 class="card-text2">Sample text.</p2>
              </div> 
            </div>
          </div>
        </div>
        <!-- Cards should appear here -->
      </div>
        <!-- Map page -->
      <div class="screen" id="map">
        <center>
          <h1>Let's look around</h1>            
              <script> 
                    let map;//creates global variable
                    function initMap() {
                      // The location of UIC
                      const chicago = { lat: 41.8696, lng: -87.6496 };
                      // Forces map to center position on UIC
                      map = new google.maps.Map(document.getElementById("map"), {
                        zoom: 4,
                        center: chicago,
                      });
                      // Places a marker on the location of UIC
                      const marker = new google.maps.Marker({
                        position: chicago,
                        map: map,
                      });
                    }
                </script>
                  <h3>Here's a Google map that points to UIC where I'm enrolled in</h3>
                    <!--The div element for the map -->
                    <div id="map"></div>                      
        </center>
      </div>
      <!-- About page -->
      <div class="screen" id="about">
          <center>
            <h5 class="card-title">Goal</h5>
                  <p class="card-text">This Single Page app is a project to allow users to search and access the Chicago City-Owned Land Inventory database. <br> This consists of an app shell model, Bootstrap for UI elements, and five screens/pages titled Home/Instruction, Form, Data, Map, and About respectively.</p>
            <div class="card" style="width: 18rem;">
              
              <div class="card-body">
                <h5 class="card-title">Created by <br> Stanley K Cheung</h5>
                
                <p class="card-text">Prefers to go by Stan.<br> A senior in UIC enrolled in IT202 taught by David Hayes.<br> When not pulling out hairs and crying about codes not working (and not realizing it's caused by a missing end bracket), he likes to spend time cooking new receipes he learns from Food Network. For other prospective projects, venture through the linked github page.</p>
                
                <a href="https://github.com/scheun3" class="btn btn-primary">Github</a>
              </div>
            </div>
          </center>
        </div>
    </div>
    <!-- End of content -->
		
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, lastly Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <!-- Typescript that makes the screens visible-->
      <script>
        // Ensures home page is always shown
        document.querySelector("#home").style.display= "block";

        let navAnchors= document.querySelectorAll("div#navbarNavAltMarkup a")

        navAnchors.forEach( (anchor) => {
          anchor.addEventListener("click", (event) => {

            //hides all the screens first
            document.querySelectorAll(".screen").forEach( (screen) => {
              screen.style.display = "none";
            });
            //read data screen attribute  
            let screen = event.target.getAttribute("data-screen");

            //find relevant screen
            let targetScreen= document.querySelector("#" + screen);

            //Executes and displays
            targetScreen.style.display= "block";
          })
        })
      </script>
      <!-- Map screen -->
      <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyARcaUReT_nLizdf897iMAPXqgw78EwURI&callback=initMap" async></script>

      <!-- Results page/Populates cards-->
        <!--Fetch request using fetch url method-->
        <script>
          let  url= "https://data.cityofchicago.org/resource/aksk-kvfp.json"

          let template= document.querySelector(".template");

          //Search box method
          document.querySelector("#searchButton").addEventListener( "click", (event) => {
            // console.log("search click")
            //Remove empty cards if called
            document.querySelectorAll(".ward_card").forEach( (node) => {
              // console.log("removing node")
              node.remove()
            });

            let type= document.querySelector("input").value;
            //Tells script to look through wards when called upon
            let url = "https://data.cityofchicago.org/resource/aksk-kvfp.json" + "?ward=" + type;
           // console.log(url)

        fetch (url)
          .then ( ( response ) => { return response.json() })
          .then ( (data) => {
            // console.log(data)
            data.forEach( (item) => {
              // console.log(item)
              let clone=template.cloneNode(true);
              //Adds name of ward to card
              let h5 = clone.querySelector("h5.card-title")
              h5.innerText = item.community_area_name;
              //Adds pin to card
              let h6 = clone.querySelector("h6.card-subtitle")
              h6.innerText= item.pin;
              //Adds address to card
              let p =clone.querySelector("p.card-text")
              p.innerText=item.address;
              //Adds square feet to card
              let p2 =clone.querySelector("p2.card-text2")
              p2.innerText=item.sq_ft;

              //Ensures accurate results by deleting empty cards
              clone.classList.remove("template");
              clone.classList.add("ward_card")
              template.parentElement.append(clone);
              
            })

          })
          });

        

        </script>
	</body>
</html>